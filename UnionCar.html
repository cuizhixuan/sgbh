<!DOCTYPE html>
            if (playerCount > 50) {
                showError('抽取人数不能超过50人');
                return;
            }
            
            // 显示加载指示器
            loadingIndicator.classList.add('show');
            resultContainer.classList.remove('show');
            
            // 模拟处理时间
            setTimeout(() => {
                try {
                    // 解析数据
                    const players = parseData(inputText);
                    if (players.length === 0) {
                        showError('无法解析数据，请检查格式是否正确');
                        loadingIndicator.classList.remove('show');
                        return;
                    }
                    
                    // 计算平均周功勋
                    const averageWeeklyMerit = calculateAverageWeeklyMerit(players);
                    
                    // 获取符合条件的玩家
                    const qualifiedPlayers = getQualifiedPlayers(players, averageWeeklyMerit);
                    
                    if (qualifiedPlayers.length === 0) {
                        showError('没有成员周功勋大于平均值');
                        loadingIndicator.classList.remove('show');
                        emptyState.style.display = 'block';
                        return;
                    }
                    
                    if (playerCount > qualifiedPlayers.length) {
                        showError(`抽取人数(${playerCount})超过符合条件的成员数(${qualifiedPlayers.length})，将抽取所有符合条件的成员`);
                    }
                    
                    // 抽取队长
                    const extractedPlayers = getRandomItems(qualifiedPlayers, Math.min(playerCount, qualifiedPlayers.length));
                    
                    // 显示结果
                    displayResults(players, qualifiedPlayers, extractedPlayers, averageWeeklyMerit);
                    
                    // 显示成功消息
                    showSuccess(`成功抽取 ${extractedPlayers.length} 位队长！`);
                    
                    // 隐藏加载指示器
                    loadingIndicator.classList.remove('show');
                } catch (error) {
                    showError('处理数据时发生错误: ' + error.message);
                    loadingIndicator.classList.remove('show');
                }
            }, 800);
        }


        // 事件监听
        extractBtn.addEventListener('click', extractCaptains);
        clearInputBtn.addEventListener('click', clearInput);
        clearInputBtnMobile.addEventListener('click', clearInput);
        loadSampleDataBtn.addEventListener('click', loadSampleData);
        loadSampleDataBtnMobile.addEventListener('click', loadSampleData);
        
        // 初始加载示例数据
        window.addEventListener('DOMContentLoaded', () => {
            dataInput.value = sampleData;
        });
        
        // 按Enter键触发抽取
        playerCountInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                extractCaptains();
            }
        });
        
        // 点击输入框外部时隐藏错误/成功消息
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.input-section')) {
                errorMessage.classList.remove('show');
                successMessage.classList.remove('show');
            }
        });
    </script>
</body>
</html>
